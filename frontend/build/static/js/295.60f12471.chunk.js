"use strict";(self.webpackChunkbcusermanagement=self.webpackChunkbcusermanagement||[]).push([[295],{9295:(e,r,a)=>{a.r(r),a.d(r,{default:()=>C});var t=a(5043),s=a(3892),o=a(899),l=a(7392),n=a(7784),i=a(1787),d=a(1906),c=a(7353),u=a(4449),m=a(5865),p=a(7561),h=a(9190),x=a(2268),y=a(8988),j=a(4054),A=a(3934),g=a(8967),b=a(4957),v=a(7488),k=a(94),I=a(5394),N=a(5051),D=a(5732),f=a(247),R=a(5218),S=a(4051),T=a(579);const B=o.Ik().shape({brokerName:o.Yj().required("Broker Name is required"),id:o.Yj().required("ID is required"),startDate:o.p6().required("Start Date is required"),employee:o.Yj().required("Employee is required"),nism:o.Yj().required("NISM is required"),idType:o.Yj().required("ID Type is required")}),w=["Id","Broker Name","Start Date","Releases Date","Employee","Nism","IdType","Action"],C=()=>{const[e,r]=(0,t.useState)([]),[a,o]=(0,t.useState)(!1),[C,E]=(0,t.useState)(!1),[q,P]=(0,t.useState)([]),[Y,W]=(0,t.useState)([]),[L,M]=(0,t.useState)(null),[U,z]=(0,t.useState)(null),[O,V]=(0,t.useState)(null),F=()=>o(!0),Z=()=>{o(!1),E(!1),M(null)},G=async()=>{try{const e=await b.A.get("/getIds");if(200===e.status){const r=e.data.data.map((e=>({Id:e.idNumber,"Broker Name":e.brokerName,"Start Date":e.startDate,"Releases Date":e.releaseDate||"-","Record Id":e.recordId,Employee:(null===e||void 0===e?void 0:e.employee)||"-",Nism:e.nism,IdType:e.idType,Action:(0,T.jsxs)(D.A,{children:[(0,T.jsx)(f.b,{children:(0,T.jsx)(l.A,{onClick:r=>((e,r)=>{z(e.currentTarget),V(r)})(r,e.recordId),children:(0,T.jsx)(N.txp,{})})}),(0,T.jsxs)(R.y,{"aria-label":"Action event example",onAction:r=>{"release"===r?J(e):"edit"===r&&H(e)},children:[(0,T.jsx)(S.Y,{isDisabled:3===e.status,children:"Release"},"release"),(0,T.jsx)(S.Y,{isDisabled:3===e.status,children:"Edit"},"edit")]})]})})));W(r)}}catch(e){v.oR.error("Error fetching ID data.")}},H=e=>{console.log(e),M(e),E(!0),F()},J=async e=>{try{await b.A.put("/releaseId/".concat(e.recordId,"/3")),v.oR.success("Released Id: ".concat(e.recordId)),G()}catch(r){v.oR.error("Error releasing broker.")}};(0,t.useEffect)((()=>{(async()=>{try{const e=await b.A.get("/users");200===e.status&&P(e.data)}catch(e){v.oR.error("Error fetching user data.")}})(),G(),(async()=>{try{const a=await b.A.get("/getAllBroker");var e;200===a.status&&r(null===a||void 0===a||null===(e=a.data)||void 0===e?void 0:e.data.filter((e=>1===e.status)))}catch(a){console.error(a),v.oR.error("Error fetching broker data.")}})()}),[]);const K={brokerName:(null===L||void 0===L?void 0:L.brokerId)||"",id:(null===L||void 0===L?void 0:L.idNumber)||"",startDate:(null===L||void 0===L?void 0:L.startDate)||"",employee:(null===L||void 0===L?void 0:L.employeeId)||"",nism:(null===L||void 0===L?void 0:L.nism)||"",idType:(null===L||void 0===L?void 0:L.idType)||""};return(0,T.jsxs)(g.A,{pageTitle:"ID Management",pageSubtitle:"Manage ID details",children:[(0,T.jsxs)(k.Z,{style:{marginTop:"1rem"},children:[(0,T.jsxs)("div",{className:"flex justify-between p-4 align-middle",children:[(0,T.jsx)(n.A,{className:"searchUser",placeholder:"Search",InputProps:{startAdornment:(0,T.jsx)(i.A,{position:"start",children:(0,T.jsx)(I.zfp,{})})}}),(0,T.jsx)(d.A,{onClick:F,variant:"contained",color:"primary",children:"Add ID"})]}),(0,T.jsx)(c.A,{mt:4,children:(0,T.jsx)(A.A,{title:w,tableData:Y})})]}),(0,T.jsx)(u.A,{open:a,onClose:Z,children:(0,T.jsxs)(c.A,{className:"modal-box",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:2,overflowY:"scroll"},children:[(0,T.jsx)(m.A,{variant:"h6",children:C?"Edit ID":"Add New ID"}),(0,T.jsx)(s.l1,{initialValues:K,validationSchema:B,onSubmit:async(e,r)=>{let{resetForm:a}=r;try{C?(await b.A.put("/updateId/".concat(L.recordId),e),v.oR.success("ID updated successfully.")):(await b.A.post("/createId",e),v.oR.success("ID added successfully.")),G(),a(),Z()}catch(t){v.oR.error("Error saving broker.")}},children:r=>{let{values:a,handleChange:t,errors:o,touched:l,handleBlur:i}=r;return(0,T.jsxs)(s.lV,{children:[(0,T.jsxs)("div",{className:"flex gap-2",children:[(0,T.jsx)(n.A,{fullWidth:!0,margin:"normal",name:"id",label:"ID",value:a.id||"",onChange:t,onBlur:i,error:l.id&&Boolean(o.id),helperText:l.id&&o.id}),(0,T.jsxs)(p.A,{fullWidth:!0,margin:"normal",error:l.brokerName&&Boolean(o.brokerName),children:[(0,T.jsx)(h.A,{id:"brokerName-label",children:"Broker Name"}),(0,T.jsx)(x.A,{labelId:"brokerName-label",id:"brokerName",name:"brokerName",label:"Broker Name",value:a.brokerName||"",onChange:t,onBlur:i,children:e&&e.map(((e,r)=>(0,T.jsx)(y.A,{value:e.id,children:e.brokerName},r)))}),l.brokerName&&Boolean(o.brokerName)&&(0,T.jsx)(j.A,{children:o.brokerName})]})]}),(0,T.jsxs)("div",{className:"flex gap-2",children:[(0,T.jsx)(n.A,{fullWidth:!0,margin:"normal",name:"startDate",label:"Start Date",type:"date",InputLabelProps:{shrink:!0},value:a.startDate||"",onChange:t,onBlur:i,error:l.startDate&&Boolean(o.startDate),helperText:l.startDate&&o.startDate}),(0,T.jsxs)(p.A,{fullWidth:!0,margin:"normal",error:l.employee&&Boolean(o.employee),children:[(0,T.jsx)(h.A,{id:"employee-label",children:"Employee"}),(0,T.jsxs)(x.A,{labelId:"employee-label",id:"employee",name:"employee",label:"Employee",value:a.employee||"",onChange:t,onBlur:i,children:[console.log(q),q&&q.map(((e,r)=>(0,T.jsx)(y.A,{value:e.id,children:e.firstName+" "+e.lastName},r)))]}),l.employee&&o.employee&&(0,T.jsx)(j.A,{children:o.employee})]})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)(n.A,{fullWidth:!0,margin:"normal",name:"nism",label:"NISM",value:a.nism||"",onChange:t,onBlur:i,error:l.nism&&Boolean(o.nism),helperText:l.nism&&o.nism}),(0,T.jsx)(n.A,{fullWidth:!0,margin:"normal",name:"idType",label:"ID Type",value:a.idType||"",onChange:t,onBlur:i,error:l.idType&&Boolean(o.idType),helperText:l.idType&&o.idType})]}),(0,T.jsxs)("div",{className:"flex gap-2 mt-2 justify-start flex-row-reverse",children:[(0,T.jsx)(d.A,{variant:"contained",color:"secondary",onClick:Z,children:"Cancel"}),(0,T.jsx)(d.A,{type:"submit",variant:"contained",color:"primary",children:C?"Update Id":"Add Id"})]})]})}})]})})]})}},3934:(e,r,a)=>{a.d(r,{A:()=>x});var t=a(5043),s=a(9650),o=a(1596),l=a(1806),n=a(4882),i=a(8076),d=a(39),c=a(8093),u=a(3460),m=a(1463),p=a(728),h=a(579);const x=e=>{let{title:r=[],tableData:a=[],renderAction:x}=e;const[y,j]=(0,t.useState)(0),[A,g]=(0,t.useState)(5),[b,v]=(0,t.useState)({key:"",direction:"asc"}),k=t.useMemo((()=>b.key?[...a].sort(((e,r)=>e[b.key]<r[b.key]?"asc"===b.direction?-1:1:e[b.key]>r[b.key]?"asc"===b.direction?1:-1:0)):a),[a,b]).slice(y*A,y*A+A);return(0,h.jsxs)(s.A,{component:o.A,className:"custom",children:[(0,h.jsxs)(l.A,{children:[(0,h.jsx)(n.A,{children:(0,h.jsx)(i.A,{children:r.map(((e,r)=>(0,h.jsx)(d.A,{align:"center",sx:{fontWeight:"bold"},children:(0,h.jsx)(c.A,{active:b.key===e.toLowerCase(),direction:b.key===e.toLowerCase()?b.direction:"asc",onClick:()=>{return r=e.toLowerCase(),void v((e=>{const a=e.key===r&&"asc"===e.direction;return{key:r,direction:a?"desc":"asc"}}));var r},children:e})},r)))})}),(0,h.jsxs)(u.A,{children:[k.map(((e,r)=>(0,h.jsx)(i.A,{children:Object.keys(e).map(((a,t)=>["status","id","brokerId","fundAllocated","Record Id"].includes(a)?null:(0,h.jsx)(d.A,{align:"center",children:"action"===a&&x?(0,h.jsx)(p.T,{isDisabled:3===e.status,onPress:()=>{return r=e.status,a=e.id,void(1===r?x(a):x());var r,a},children:1===e.status?"Release":"Released"}):e[a]},"".concat(r,"-").concat(t))))},r))),k&&0===k.length&&(0,h.jsx)(i.A,{style:{textAlign:"center"},children:(0,h.jsx)(d.A,{colSpan:r.length,className:"middle-noData",children:"No data found."})})]})]}),(0,h.jsx)(m.A,{component:"div",count:a.length,page:y,onPageChange:(e,r)=>{j(r)},rowsPerPage:A,onRowsPerPageChange:e=>{g(parseInt(e.target.value,10)),j(0)},rowsPerPageOptions:[5,10,15]})]})}},4957:(e,r,a)=>{a.d(r,{A:()=>s});const t=a(9722).A.create({baseURL:"http://43.204.150.47:8000",timeout:5e3});t.interceptors.request.use((e=>(e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e)),(e=>(console.error("Request Interceptor Error:",e),Promise.reject(e)))),t.interceptors.response.use((e=>(console.log("Response Interceptor: Response received"),e)),(e=>(e.response&&401===e.response.status?console.error("Response Interceptor: Unauthorized access - Redirecting to login"):console.error("Response Interceptor Error:",e.message),Promise.reject(e))));const s=t}}]);
//# sourceMappingURL=295.60f12471.chunk.js.map