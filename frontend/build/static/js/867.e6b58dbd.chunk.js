"use strict";(self.webpackChunkbcusermanagement=self.webpackChunkbcusermanagement||[]).push([[867],{8867:(e,r,n)=>{n.r(r),n.d(r,{default:()=>B});var a=n(5043),t=n(7392),s=n(7784),o=n(1906),i=n(3934),d=n(9014),l=n(4957),u=n(7488),c=n(1787),g=n(3892),h=n(899),p=n(4449),F=n(7353),m=n(5865),b=n(579);const x=h.Ik().shape({brokerName:h.Yj().required("Broker Name is required"),grossFund:h.ai().typeError("Gross Fund must be a number").min(0,"Gross Fund must be greater than or equal to 0").required("Gross Fund is required"),grossFundInterest:h.ai().typeError("Gross Fund Interest must be a number").min(0,"Interest must be at least 0%").max(100,"Interest cannot exceed 100%").required("Gross Fund Interest is required"),grossFundSharing:h.ai().typeError("Gross Fund Sharing must be a number").min(0,"Sharing must be at least 0%").max(100,"Sharing cannot exceed 100%").required("Gross Fund Sharing is required"),arbitrageFund:h.ai().typeError("Arbitrage Fund must be a number").min(0,"Arbitrage Fund must be greater than or equal to 0").required("Arbitrage Fund is required"),arbitrageFundInterest:h.ai().typeError("Arbitrage Fund Interest must be a number").min(0,"Interest must be at least 0%").max(100,"Interest cannot exceed 100%").required("Arbitrage Fund Interest is required"),arbitrageFundSharing:h.ai().typeError("Arbitrage Fund Sharing must be a number").min(0,"Sharing must be at least 0%").max(100,"Sharing cannot exceed 100%").required("Arbitrage Fund Sharing is required"),propFund:h.ai().typeError("Prop Fund must be a number").min(0,"Prop Fund must be greater than or equal to 0").required("Prop Fund is required"),propFundInterest:h.ai().typeError("Prop Fund Interest must be a number").min(0,"Interest must be at least 0%").max(100,"Interest cannot exceed 100%").required("Prop Fund Interest is required"),propFundSharing:h.ai().typeError("Prop Fund Sharing must be a number").min(0,"Sharing must be at least 0%").max(100,"Sharing cannot exceed 100%").required("Prop Fund Sharing is required"),costPerCr:h.ai().typeError("Cost must be a number").min(0,"Cost must be greater than or equal to 0").required("Cost is required")}),v=e=>{let{open:r,handleClose:n,onFormSubmit:a,brokerData:t}=e;const i={id:(null===t||void 0===t?void 0:t.id)||null,brokerName:(null===t||void 0===t?void 0:t.brokerName)||"",grossFund:(null===t||void 0===t?void 0:t.grossFund)||0,grossFundInterest:(null===t||void 0===t?void 0:t.grossFundInterest)||0,grossFundSharing:(null===t||void 0===t?void 0:t.grossFundSharing)||0,arbitrageFund:(null===t||void 0===t?void 0:t.arbitrageFund)||0,arbitrageFundInterest:(null===t||void 0===t?void 0:t.arbitrageFundInterest)||0,arbitrageFundSharing:(null===t||void 0===t?void 0:t.arbitrageFundSharing)||0,propFund:(null===t||void 0===t?void 0:t.propFund)||0,propFundInterest:(null===t||void 0===t?void 0:t.propFundInterest)||0,propFundSharing:(null===t||void 0===t?void 0:t.propFundSharing)||0,costPerCr:(null===t||void 0===t?void 0:t.costPerCr)||0};return(0,b.jsx)(p.A,{open:r,onClose:n,children:(0,b.jsxs)(F.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:2,overflowY:"auto"},children:[(0,b.jsx)(m.A,{variant:"h6",sx:{marginBottom:"20px"},children:i.id?"Update Broker":"Add Broker"}),(0,b.jsx)(g.l1,{initialValues:i,validationSchema:x,onSubmit:async(e,r)=>{let{resetForm:t}=r;try{e.id?(await l.A.put("/updateBroker/".concat(e.id),e),u.oR.success("Broker updated successfully.")):(await l.A.post("/createBroker",e),u.oR.success("Broker added successfully.")),a(),t(),n()}catch(d){var s,o,i;console.error(null===d||void 0===d||null===(s=d.response)||void 0===s?void 0:s.data),u.oR.error((null===d||void 0===d||null===(o=d.response)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.detail)||"An error occurred.")}},enableReinitialize:!0,children:e=>{let{values:r,errors:a,touched:t,handleChange:d,handleBlur:l,setFieldValue:u}=e;return(0,b.jsx)(g.lV,{children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsx)(s.A,{name:"brokerName",label:"Broker Name",value:r.brokerName,onChange:e=>{const r=e.target.value.toUpperCase();u("brokerName",r)},onBlur:l,error:t.brokerName&&Boolean(a.brokerName),helperText:t.brokerName&&a.brokerName,fullWidth:!0,inputProps:{style:{textTransform:"uppercase"}}}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(s.A,{name:"grossFund",label:"Gross Fund (1Cr)",value:r.grossFund,onChange:d,onBlur:l,error:t.grossFund&&Boolean(a.grossFund),helperText:t.grossFund&&a.grossFund,fullWidth:!0}),(0,b.jsx)(s.A,{name:"grossFundInterest",label:"Interest (%)",value:r.grossFundInterest,onChange:d,onBlur:l,error:t.grossFundInterest&&Boolean(a.grossFundInterest),helperText:t.grossFundInterest&&a.grossFundInterest,fullWidth:!0}),(0,b.jsx)(s.A,{name:"grossFundSharing",label:"Sharing (%)",value:r.grossFundSharing,onChange:d,onBlur:l,error:t.grossFundSharing&&Boolean(a.grossFundSharing),helperText:t.grossFundSharing&&a.grossFundSharing,fullWidth:!0})]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(s.A,{name:"arbitrageFund",label:"Arbitrage Fund (1Cr)",value:r.arbitrageFund,onChange:d,onBlur:l,error:t.arbitrageFund&&Boolean(a.arbitrageFund),helperText:t.arbitrageFund&&a.arbitrageFund,fullWidth:!0}),(0,b.jsx)(s.A,{name:"arbitrageFundInterest",label:"Interest (%)",value:r.arbitrageFundInterest,onChange:d,onBlur:l,error:t.arbitrageFundInterest&&Boolean(a.arbitrageFundInterest),helperText:t.arbitrageFundInterest&&a.arbitrageFundInterest,fullWidth:!0}),(0,b.jsx)(s.A,{name:"arbitrageFundSharing",label:"Sharing (%)",value:r.arbitrageFundSharing,onChange:d,onBlur:l,error:t.arbitrageFundSharing&&Boolean(a.arbitrageFundSharing),helperText:t.arbitrageFundSharing&&a.arbitrageFundSharing,fullWidth:!0})]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(s.A,{name:"propFund",label:"Prop Fund (1Cr)",value:r.propFund,onChange:d,onBlur:l,error:t.propFund&&Boolean(a.propFund),helperText:t.propFund&&a.propFund,fullWidth:!0}),(0,b.jsx)(s.A,{name:"propFundInterest",label:"Interest (%)",value:r.propFundInterest,onChange:d,onBlur:l,error:t.propFundInterest&&Boolean(a.propFundInterest),helperText:t.propFundInterest&&a.propFundInterest,fullWidth:!0}),(0,b.jsx)(s.A,{name:"propFundSharing",label:"Sharing (%)",value:r.propFundSharing,onChange:d,onBlur:l,error:t.propFundSharing&&Boolean(a.propFundSharing),helperText:t.propFundSharing&&a.propFundSharing,fullWidth:!0})]}),(0,b.jsx)(s.A,{name:"costPerCr",label:"Cost Per Cr",value:r.costPerCr,onChange:d,onBlur:l,error:t.costPerCr&&Boolean(a.costPerCr),helperText:t.costPerCr&&a.costPerCr,fullWidth:!0,margin:"normal"}),(0,b.jsxs)("div",{className:"flex justify-end gap-4 mt-4",children:[(0,b.jsx)(o.A,{variant:"contained",color:"secondary",onClick:n,children:"Cancel"}),(0,b.jsx)(o.A,{type:"submit",variant:"contained",color:"primary",children:i.id?"Update Broker":"Add Broker"})]})]})})}})]})})};var A=n(94),S=n(5394),j=n(5051),k=n(5732),I=n(247),C=n(5218),f=n(4051);const y=["BrokerName","GrossFund","ArbitrageFund","PropFund","CostPerCr","Total Fund","Start Date","Realease Date","Action"],B=()=>{const[e,r]=(0,a.useState)([]),[n,g]=(0,a.useState)(null),[h,p]=(0,a.useState)(!1),[F,m]=(0,a.useState)(null),x=(0,a.useCallback)((async()=>{p(!0);try{const a=await l.A.get("/getAllBroker");if(200===a.status){var e,n;const s=null===(e=a.data)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((e=>({"Broker Name":e.brokerName,"Gross Fund":void 0!==e.grossFund?"I ".concat(e.grossFundInterest," | F ").concat(e.grossFund," | S ").concat(e.grossFundSharing):"-","Arbitrage Fund":void 0!==e.arbitrageFund?"I ".concat(e.arbitrageFundInterest," | F ").concat(e.arbitrageFund," | S ").concat(e.arbitrageFundSharing):"-","Prop Fund":void 0!==e.propFund?"I ".concat(e.propFundInterest," | F ").concat(e.propFund," | S ").concat(e.propFundSharing):"-","Cost Per Cr":e.costPerCr||"-","Total Fund":void 0!==e.grossFund&&void 0!==e.arbitrageFund&&void 0!==e.propFund?e.grossFund+e.arbitrageFund+e.propFund:"-","Start Date":e.startDate||"-","Release Date":e.releaseDate||"-",Action:(0,b.jsxs)(k.A,{children:[(0,b.jsx)(I.b,{children:(0,b.jsx)(t.A,{children:(0,b.jsx)(j.txp,{})})}),(0,b.jsxs)(C.y,{"aria-label":"Action menu",onAction:r=>B(r,e),children:[(0,b.jsx)(f.Y,{isDisabled:3===e.status,children:"Release"},"release"),(0,b.jsx)(f.Y,{isDisabled:3===e.status,children:"Edit"},"edit")]})]})})));r(s)}else u.oR.error("Failed to fetch broker data.")}catch(a){console.error(a),u.oR.error("Error fetching broker data.")}finally{p(!1)}}),[]),B=(e,r)=>{"release"===e?P(r):"edit"===e&&(m(r),g(document.body))},P=async e=>{try{200===(await l.A.put("/releaseBroker/".concat(e.id,"/3"))).status&&(u.oR.success('Broker "'.concat(e.brokerName,'" released successfully.')),x())}catch(r){console.error(r),u.oR.error("Error releasing broker.")}};return(0,a.useEffect)((()=>{x()}),[x]),(0,b.jsx)(d.A,{pageTitle:"Brokers",pageSubtitle:"Add, view, and release brokers",children:(0,b.jsxs)(A.Z,{className:"settings-mainCard",style:{marginTop:"1rem",width:"100%",overflowY:"scroll"},children:[(0,b.jsxs)("div",{className:"flex justify-between p-4 align-middle broker-form",children:[(0,b.jsx)(s.A,{className:"searchUser",placeholder:"Search",InputProps:{startAdornment:(0,b.jsx)(c.A,{position:"start",children:(0,b.jsx)(S.zfp,{})})}}),(0,b.jsx)(o.A,{variant:"contained",color:"primary",onClick:e=>g(e.currentTarget),startIcon:(0,b.jsx)(S.QwN,{}),children:"Add Broker"})]}),(0,b.jsx)(v,{anchorEl:n,open:Boolean(n),handleClose:()=>{g(null),m(null)},onFormSubmit:x,brokerData:F}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(i.A,{columnWidths:["10%","10%","10%","10%","15%","10%","10%","10%","40%","15%","10%"],title:y,tableData:e,loading:h})})]})})}},3934:(e,r,n)=>{n.d(r,{A:()=>m});var a=n(5043),t=n(1596),s=n(9650),o=n(1806),i=n(4882),d=n(8076),l=n(39),u=n(8093),c=n(3460),g=n(1637),h=n(1463),p=n(728),F=n(579);const m=e=>{let{title:r=[],columnWidths:n=[],tableData:m=[],renderAction:b,loading:x}=e;const[v,A]=(0,a.useState)(0),[S,j]=(0,a.useState)(5),[k,I]=(0,a.useState)({key:"",direction:"asc"}),C=e=>{I((r=>{const n=r.key===e&&"asc"===r.direction;return{key:e,direction:n?"desc":"asc"}}))},f=a.useMemo((()=>k.key?[...m].sort(((e,r)=>e[k.key]<r[k.key]?"asc"===k.direction?-1:1:e[k.key]>r[k.key]?"asc"===k.direction?1:-1:0)):m),[m,k]).slice(v*S,v*S+S);return(0,F.jsxs)(t.A,{className:"custom",children:[(0,F.jsx)(s.A,{children:(0,F.jsxs)(o.A,{className:"tble-custom",children:[(0,F.jsx)(i.A,{children:(0,F.jsx)(d.A,{children:r.map(((e,r)=>"Gross Fund"===e?(0,F.jsx)(l.A,{align:"center",sx:{fontWeight:"bold",minWidth:200,maxWidth:300},children:(0,F.jsx)(u.A,{active:"grossFund"===k.key,direction:"grossFund"===k.key?k.direction:"asc",onClick:()=>C("grossFund"),children:"Gross Fund (Fund | Interest | Sharing)"})},"grossFund"):(0,F.jsx)(l.A,{align:"center",sx:{fontWeight:"bold",width:n[r]||"auto",minWidth:n[r]||150,maxWidth:n[r]||300},children:(0,F.jsx)(u.A,{active:k.key===e.toLowerCase(),direction:k.key===e.toLowerCase()?k.direction:"asc",onClick:()=>C(e.toLowerCase()),children:e})},r)))})}),(0,F.jsxs)(c.A,{children:[x&&(0,F.jsx)(d.A,{children:(0,F.jsx)(l.A,{colSpan:r.length,className:"middle-noData",children:(0,F.jsx)(g.A,{})})}),f.map(((e,r)=>(0,F.jsx)(d.A,{children:Object.keys(e).map(((a,t)=>["status","id","brokerId","fundAllocated","Record Id"].includes(a)?null:"grossFund"===a?(0,F.jsx)(l.A,{align:"center",sx:{minWidth:200,maxWidth:300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"".concat(e.grossFund," | ").concat(e.grossFundInterest," | ").concat(e.grossFundSharing)},"".concat(r,"-grossFund")):(0,F.jsx)(l.A,{align:"center",sx:{width:n[t]||"auto",minWidth:n[t]||150,maxWidth:n[t]||300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"action"===a&&b?(0,F.jsx)(p.T,{isDisabled:3===e.status,onPress:()=>{return r=e.status,n=e.id,void(1===r?b(n):b());var r,n},children:1===e.status?"Release":"Released"}):e[a]},"".concat(r,"-").concat(t))))},r))),!x&&0===f.length&&(0,F.jsx)(d.A,{children:(0,F.jsx)(l.A,{colSpan:r.length,className:"middle-noData",align:"center",children:"No data found."})})]})]})}),(0,F.jsx)(h.A,{component:"div",count:m.length,page:v,onPageChange:(e,r)=>A(r),rowsPerPage:S,onRowsPerPageChange:e=>{j(parseInt(e.target.value,10)),A(0)},rowsPerPageOptions:[5,10,15]})]})}},4957:(e,r,n)=>{n.d(r,{A:()=>t});const a=n(9722).A.create({baseURL:"http://43.204.150.47:8000",timeout:5e3});a.interceptors.request.use((e=>(e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e)),(e=>(console.error("Request Interceptor Error:",e),Promise.reject(e)))),a.interceptors.response.use((e=>(console.log("Response Interceptor: Response received"),e)),(e=>(e.response&&401===e.response.status?console.error("Response Interceptor: Unauthorized access - Redirecting to login"):console.error("Response Interceptor Error:",e.message),Promise.reject(e))));const t=a}}]);
//# sourceMappingURL=867.e6b58dbd.chunk.js.map