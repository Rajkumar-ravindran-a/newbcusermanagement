"use strict";(self.webpackChunkbcusermanagement=self.webpackChunkbcusermanagement||[]).push([[295],{9295:(e,r,a)=>{a.r(r),a.d(r,{default:()=>C});var s=a(5043),t=a(3892),l=a(899),n=a(7392),o=a(7784),i=a(1787),d=a(7561),c=a(2268),u=a(8988),m=a(1906),h=a(7353),p=a(4449),x=a(5865),j=a(9190),g=a(4054),A=a(3934),y=a(8967),v=a(4957),b=a(7488),k=a(94),I=a(5394),N=a(5051),D=a(5732),f=a(247),S=a(5218),w=a(4051),T=a(579);const R=l.Ik().shape({brokerName:l.Yj().required("Broker Name is required"),id:l.Yj().required("ID is required"),startDate:l.p6().required("Start Date is required"),employee:l.Yj().required("Employee is required"),nism:l.Yj().required("NISM is required"),idType:l.Yj().required("ID Type is required")}),B=["Id","Broker Name","Start Date","Releases Date","Employee","Nism","IdType","Action"],C=()=>{const[e,r]=(0,s.useState)([]),[a,l]=(0,s.useState)(""),[C,W]=(0,s.useState)([]),[E,q]=(0,s.useState)([]),[F,P]=(0,s.useState)(!1),[M,Y]=(0,s.useState)(!1),[L,O]=(0,s.useState)([]),[U,z]=(0,s.useState)(null),[G,V]=(0,s.useState)(!1),[X]=(0,s.useState)(["Manual-ODIN","Manual-GREEK","Manual-XTS","Convex","XTS-API"]),K=async()=>{try{V(!0);const e=await v.A.get("/getIds");if(200===e.status){const r=e.data.data.map((e=>({Id:e.idNumber,"Broker Name":e.brokerName,"Start Date":e.startDate,"Releases Date":e.releaseDate||"-","Record Id":e.recordId,Employee:(null===e||void 0===e?void 0:e.employeeId)||"-",Nism:e.nism,IdType:e.idType,Action:(0,T.jsxs)(D.A,{children:[(0,T.jsx)(f.b,{children:(0,T.jsx)(n.A,{children:(0,T.jsx)(N.txp,{})})}),(0,T.jsxs)(S.y,{"aria-label":"Action event example",onAction:r=>{"release"===r?J(e):"edit"===r&&H(e)},children:[(0,T.jsx)(w.Y,{isDisabled:3===e.status,children:"Release"},"release"),(0,T.jsx)(w.Y,{isDisabled:3===e.status,children:"Edit"},"edit")]})]})})));W(r),q(r),V(!1)}}catch(e){V(!1),console.error(e)}},Q=()=>P(!0),Z=()=>{P(!1),Y(!1),z(null)},H=e=>{z(e),Y(!0),Q()},J=async e=>{try{await v.A.put("/releaseId/".concat(e.recordId,"/3")),b.oR.success("Released Id: ".concat(e.recordId)),K()}catch(r){b.oR.error("Error releasing broker.")}};(0,s.useEffect)((()=>{(async()=>{try{const e=await v.A.get("/users");200===e.status&&O(e.data)}catch(e){console.error(e)}})(),K(),(async()=>{try{const a=await v.A.get("/getAllBroker");var e;200===a.status&&r(null===a||void 0===a||null===(e=a.data)||void 0===e?void 0:e.data.filter((e=>1===e.status)))}catch(a){console.error(a),b.oR.error("Error fetching broker data.")}})()}),[]);const $={brokerName:(null===U||void 0===U?void 0:U.brokerId)||"",id:(null===U||void 0===U?void 0:U.idNumber)||"",startDate:(null===U||void 0===U?void 0:U.startDate)||"",employee:(null===U||void 0===U?void 0:U.employeeId)||"",nism:(null===U||void 0===U?void 0:U.nism)||"",idType:(null===U||void 0===U?void 0:U.idType)||""};return(0,T.jsxs)(y.A,{pageTitle:"ID Management",pageSubtitle:"Manage ID details",children:[(0,T.jsxs)(k.Z,{style:{marginTop:"1rem"},children:[(0,T.jsxs)("div",{className:"flex justify-between p-4 align-middle",children:[(0,T.jsxs)("div",{className:"flex gap-3",children:[(0,T.jsx)(o.A,{className:"searchUser",placeholder:"Search",InputProps:{startAdornment:(0,T.jsx)(i.A,{position:"start",children:(0,T.jsx)(I.zfp,{})})}}),(0,T.jsx)(d.A,{style:{minWidth:200,marginRight:"1rem"},children:(0,T.jsxs)(c.A,{value:a,onChange:e=>{const r=e.target.value;if(l(r),r){const e=C.filter((e=>e["Broker Name"]===r));q(e)}else q(C)},displayEmpty:!0,children:[(0,T.jsx)(u.A,{value:"",children:"All Brokers"}),e.map(((e,r)=>(0,T.jsx)(u.A,{value:e.brokerName,children:e.brokerName},r)))]})})]}),(0,T.jsx)(m.A,{onClick:Q,variant:"contained",color:"primary",startIcon:(0,T.jsx)(I.QwN,{}),children:"Add ID"})]}),(0,T.jsx)(h.A,{mt:4,children:(0,T.jsx)(A.A,{title:B,tableData:E,loading:G})})]}),(0,T.jsx)(p.A,{open:F,onClose:Z,children:(0,T.jsxs)(h.A,{className:"modal-box",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:2,overflowY:"scroll"},children:[(0,T.jsx)(x.A,{variant:"h6",children:M?"Edit ID":"Add New ID"}),(0,T.jsx)(t.l1,{initialValues:$,validationSchema:R,onSubmit:async(e,r)=>{let{resetForm:a}=r;try{M?(await v.A.put("/updateId/".concat(U.recordId),e),b.oR.success("ID updated successfully.")):(await v.A.post("/createId",e),b.oR.success("ID added successfully.")),K(),a(),Z()}catch(o){var s,t,l,n;console.error(null===o||void 0===o||null===(s=o.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail),b.oR.error(null===o||void 0===o||null===(l=o.response)||void 0===l||null===(n=l.data)||void 0===n?void 0:n.detail)}},children:r=>{let{values:a,handleChange:s,errors:l,touched:n,handleBlur:i}=r;return(0,T.jsxs)(t.lV,{children:[(0,T.jsxs)("div",{className:"flex gap-2",children:[(0,T.jsx)(o.A,{fullWidth:!0,margin:"normal",name:"id",label:"ID",value:a.id||"",onChange:s,onBlur:i,error:n.id&&Boolean(l.id),helperText:n.id&&l.id}),(0,T.jsxs)(d.A,{fullWidth:!0,margin:"normal",error:n.brokerName&&Boolean(l.brokerName),children:[(0,T.jsx)(j.A,{id:"brokerName-label",children:"Broker Name"}),(0,T.jsx)(c.A,{labelId:"brokerName-label",id:"brokerName",name:"brokerName",label:"Broker Name",value:a.brokerName||"",onChange:s,onBlur:i,children:e.map(((e,r)=>(0,T.jsx)(u.A,{value:e.id,children:e.brokerName},r)))}),n.brokerName&&Boolean(l.brokerName)&&(0,T.jsx)(g.A,{children:l.brokerName})]})]}),(0,T.jsxs)("div",{className:"flex gap-2",children:[(0,T.jsx)(o.A,{fullWidth:!0,margin:"normal",name:"startDate",label:"Start Date",type:"date",InputLabelProps:{shrink:!0},value:a.startDate||"",onChange:s,onBlur:i,error:n.startDate&&Boolean(l.startDate),helperText:n.startDate&&l.startDate}),(0,T.jsxs)(d.A,{fullWidth:!0,margin:"normal",error:n.employee&&Boolean(l.employee),children:[(0,T.jsx)(j.A,{id:"employee-label",children:"Employee"}),(0,T.jsx)(c.A,{labelId:"employee-label",id:"employee",name:"employee",label:"Employee",value:a.employee||"",onChange:s,onBlur:i,children:L.map(((e,r)=>(0,T.jsx)(u.A,{value:e.id,children:e.firstName+" "+e.lastName},r)))}),n.employee&&l.employee&&(0,T.jsx)(g.A,{children:l.employee})]})]}),(0,T.jsxs)("div",{className:"flex gap-2",children:[(0,T.jsx)(o.A,{fullWidth:!0,margin:"normal",name:"nism",label:"NISM",value:a.nism||"",onChange:s,onBlur:i,error:n.nism&&Boolean(l.nism),helperText:n.nism&&l.nism}),(0,T.jsxs)(d.A,{fullWidth:!0,margin:"normal",error:n.idType&&Boolean(l.idType),children:[(0,T.jsx)(j.A,{id:"IDType",children:"ID Type"}),(0,T.jsx)(c.A,{labelId:"IDType",id:"IDType",name:"idType",label:"ID Type",value:a.idType||"",onChange:s,onBlur:i,children:void 0!==X&&(null===X||void 0===X?void 0:X.map(((e,r)=>(0,T.jsx)(u.A,{value:e,children:e},r))))}),n.idType&&Boolean(l.idType)&&(0,T.jsx)(g.A,{children:l.idType})]})]}),(0,T.jsxs)("div",{className:"flex justify-end gap-4 mt-6",children:[(0,T.jsx)(m.A,{variant:"contained",color:"error",onClick:Z,children:"Cancel"}),(0,T.jsx)(m.A,{variant:"contained",color:"primary",type:"submit",children:M?"Update":"Add"})]})]})}})]})})]})}},3934:(e,r,a)=>{a.d(r,{A:()=>j});var s=a(5043),t=a(1596),l=a(9650),n=a(1806),o=a(4882),i=a(8076),d=a(39),c=a(8093),u=a(3460),m=a(1637),h=a(1463),p=a(728),x=a(579);const j=e=>{let{title:r=[],columnWidths:a=[],tableData:j=[],renderAction:g,loading:A}=e;const[y,v]=(0,s.useState)(0),[b,k]=(0,s.useState)(5),[I,N]=(0,s.useState)({key:"",direction:"asc"}),D=e=>{N((r=>{const a=r.key===e&&"asc"===r.direction;return{key:e,direction:a?"desc":"asc"}}))},f=s.useMemo((()=>I.key?[...j].sort(((e,r)=>e[I.key]<r[I.key]?"asc"===I.direction?-1:1:e[I.key]>r[I.key]?"asc"===I.direction?1:-1:0)):j),[j,I]).slice(y*b,y*b+b);return(0,x.jsxs)(t.A,{className:"custom",children:[(0,x.jsx)(l.A,{children:(0,x.jsxs)(n.A,{className:"tble-custom",children:[(0,x.jsx)(o.A,{children:(0,x.jsx)(i.A,{children:r.map(((e,r)=>"Gross Fund"===e?(0,x.jsx)(d.A,{align:"center",sx:{fontWeight:"bold",minWidth:200,maxWidth:300},children:(0,x.jsx)(c.A,{active:"grossFund"===I.key,direction:"grossFund"===I.key?I.direction:"asc",onClick:()=>D("grossFund"),children:"Gross Fund (Fund | Interest | Sharing)"})},"grossFund"):(0,x.jsx)(d.A,{align:"center",sx:{fontWeight:"bold",width:a[r]||"auto",minWidth:a[r]||150,maxWidth:a[r]||300},children:(0,x.jsx)(c.A,{active:I.key===e.toLowerCase(),direction:I.key===e.toLowerCase()?I.direction:"asc",onClick:()=>D(e.toLowerCase()),children:e})},r)))})}),(0,x.jsxs)(u.A,{children:[A&&(0,x.jsx)(i.A,{children:(0,x.jsx)(d.A,{colSpan:r.length,className:"middle-noData",children:(0,x.jsx)(m.A,{})})}),f.map(((e,r)=>(0,x.jsx)(i.A,{children:Object.keys(e).map(((s,t)=>["status","id","brokerId","fundAllocated","Record Id"].includes(s)?null:"grossFund"===s?(0,x.jsx)(d.A,{align:"center",sx:{minWidth:200,maxWidth:300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"".concat(e.grossFund," | ").concat(e.grossFundInterest," | ").concat(e.grossFundSharing)},"".concat(r,"-grossFund")):(0,x.jsx)(d.A,{align:"center",sx:{width:a[t]||"auto",minWidth:a[t]||150,maxWidth:a[t]||300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"action"===s&&g?(0,x.jsx)(p.T,{isDisabled:3===e.status,onPress:()=>{return r=e.status,a=e.id,void(1===r?g(a):g());var r,a},children:1===e.status?"Release":"Released"}):e[s]},"".concat(r,"-").concat(t))))},r))),!A&&0===f.length&&(0,x.jsx)(i.A,{children:(0,x.jsx)(d.A,{colSpan:r.length,className:"middle-noData",align:"center",children:"No data found."})})]})]})}),(0,x.jsx)(h.A,{component:"div",count:j.length,page:y,onPageChange:(e,r)=>v(r),rowsPerPage:b,onRowsPerPageChange:e=>{k(parseInt(e.target.value,10)),v(0)},rowsPerPageOptions:[5,10,15]})]})}},4957:(e,r,a)=>{a.d(r,{A:()=>t});const s=a(9722).A.create({baseURL:"http://43.204.150.47:8000",timeout:5e3});s.interceptors.request.use((e=>(e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e)),(e=>(console.error("Request Interceptor Error:",e),Promise.reject(e)))),s.interceptors.response.use((e=>(console.log("Response Interceptor: Response received"),e)),(e=>(e.response&&401===e.response.status?console.error("Response Interceptor: Unauthorized access - Redirecting to login"):console.error("Response Interceptor Error:",e.message),Promise.reject(e))));const t=s}}]);
//# sourceMappingURL=295.85f566ee.chunk.js.map